#include "pm_motor.hpp"
#include "pm_sys.hpp"
#include "pm_gate3.hpp"
#include "pm_enctable.hpp"

PMMotor::PMMotor() = default;

PMMotor::PMMotor(PMSys Sys, PMGate3 CK3WAX[], PMEncTable EncTable[]) : PMMotor() {
    Ctrl = Sys.ServoCtrl;
    Servo = PMServo();
    PhasePosSf = 0.00800000000000000017;
    Pos2Sf = 1;
    PosSf = 1;
    MasterPosSf = 1;
    ProgJogPos = 0;
    IdCmd = 0;
    IaBias = 0;
    IbBias = 0;
    SlipGain = 0;
    IiGain = 0.0099999998;
    IpfGain = 1;
    IpbGain = 0;
    IxCoupleGain = 0;
    AdvGain = 0;
    DtOverRotorTc = 0;
    MotorTa = 0;
    MotorTs = 0;
    JogTa = 0;
    JogTs = 0;
    AbortTa = -2;
    AbortTs = 0;
    MaxSpeed = 131.07201;
    JogSpeed = 0.80000001;
    HomeVel = 10;
    HomeOffset = 0;
    InvAmax = 10;
    InvJmax = 50;
    FatalFeLimit = 16000;
    WarnFeLimit = 8000;
    MaxPos = 0;
    MinPos = 0;
    InPosBand = 80;
    I2tSet = 0;
    I2tTrip = 0;
    JogOffset = 0;
    AdcMask = 0xfff00000;
    PhaseOffset = -683;
    Stime = 0;
    PwmSf = 18918;
    MaxDac = 32767;
    DacBias = 0;
    pSineTable = &Sys.SineTable[0];
    pVoltSineTable = &Sys.SineTable[0];
    pDac = &CK3WAX[0].Chan[0].Pwm[0];
    pAdc = &CK3WAX[0].Chan[0].AdcAmp[0];
    pPhaseEnc = &CK3WAX[0].Chan[0].PhaseCapt;
    pEncStatus = &CK3WAX[0].Chan[0].Status;
    pEncCtrl = &CK3WAX[0].Chan[0].OutCtrl;
    pEnc2 = &EncTable[1];
    pEncLoss = 0;
    pMasterEnc = &EncTable[0];
    EncType = 5;
    AmpEnableBit = 8;
    LimitBits = 9;
    InvDmax = 10;
    InPosTime = 0;
    Pd1 = 0;
    Pd2 = 0;
    Pd3 = 0;
    Pd4 = 0;
    Pn0 = 0;
    Pn1 = 0;
    Pn2 = 0;
    Pn3 = 0;
    Pn4 = 0;
    PreFilterEna = 0;
    PhaseFindingDac = 0;
    PhaseFindingTime = 0;
    pAmpEnable = &CK3WAX[0].Chan[0].OutCtrl;
    pAmpFault = &CK3WAX[0].Chan[0].Status;
    pLimits = 0;
    BlSlewRate = 0;
    BlSize = 0;
    BlHysteresis = 0;
    AbsPhasePosOffset = 0;
    AbsPhasePosFormat = 0x0;
    AbsPhasePosSf = 0;
    pAbsPhasePos = 0;
    AbsPosFormat = 0x0;
    AbsPosSf = 0;
    pAbsPos = 0;
    AbsPhasePosForce = 0;
    AmpFaultBit = 7;
    CmdMotor = 0;
    GantrySlewRate = 0;
    pBrakeOut = 0;
    BrakeOnDelay = 0;
    BrakeOffDelay = 0;
    BrakeOutBit = 9;
    CaptControl = 0x14080801;
    pCaptFlag = &CK3WAX[0].Chan[0].Status;
    pCaptPos = &CK3WAX[0].Chan[0].HomeCapt;
    ExtraMotors = 0;
    pBufPos2 = 0;
    pBufPos = 0;
    pEnc = &EncTable[1];
    EncLossBit = 0;
    EncLossLimit = 0;
    SlewMasterPosSf = 0;
    MasterMaxSpeed = 0;
    MasterMaxAccel = 0;
    ServoCaptTimeOffset = 0;
    SineTableSize = 2048;
    PwmDbComp = 0;
    PwmDbI = 0;
    SoftLimitOffset = 0;
    CurrentNullPeriod = 0;
    pMotorNode = Sys.pushm;
    MotorNodeOffset = 0;
    MotorModeCmdPosSf = 1;
    pPhaseLoadEnc = 0;
    pAuxFault = 0;
    AuxFaultBit = 0;
    AuxFaultLimit = 0;
    TraceSize = 0;
    EcatAmpFaultLimit = 0x3e8;
    Vqff = 0;
    pCascadeCmd = 0;
    pCaptEna = 0;
    Pos2Unit = 0;
    PosUnit = 0;
    CurrentScale = 0;
    pDac2 = 0;
    pAbsPos2 = 0;
    MotorModeEncSf = 1;
    MotorMode = 0;
    LimitLimit = 0;
    AmpFaultLimit = 0;
    Control[0] = 0x10000d00;
    Control[1] = 0x0;
}
